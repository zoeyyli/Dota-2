# Results

```{r}
library(tidyverse)
dota2 <- read.csv("addata.csv")
dota2 |> drop_na()
```

## Select Ability Phase
Before answering the research questions, we need to select the abilities we would like to analyze. There are over 500 abilities in total, which is an extremely large pool, so we decide to choose 30 of them with the most sufficient data given. Thus, firstly, we will draw the barplot showing the frequencies of all abilities, and our goal is to select the top 30 to do the future analysis. 

```{r}
df = as.data.frame(table(dota2$ability))
names(df)[1] = 'ability'
df$rank = rank(df$Freq)
df <- df[order(df$rank,decreasing=TRUE),]
df <- head(df,30)
df
```

```{r}
library(ggplot2)
library(forcats)
ggplot(df, aes(x=reorder(ability,-Freq),y=Freq))+
  geom_col(color='blue', fill ='cornflowerblue', width=0.8)+
  labs(title="Frequency Count of Top 30 Abilities",x="Ability", y = "Count")+
  theme(axis.text.x = element_text(angle = 90, size = 8)) 
```
```{r}
dota2 <- dota2[dota2$ability %in% df$ability,]
dota2 %>% distinct()
```

Now the dataframe only contains data for 20 selected abilities. 

## First Research Question

- Which abilities have the highest damage, kills, gold, experiences points earned, and kda (a statistic that is used to measure a player's performance), and are therefore the most valuable?

To answer the question, we decide to draw parallel coordinate plots which is useful when we want to get the abilities that top the charts in all five indicators. We make it interactive such that we can move axis around and we can filter for particular section which easier to see the top abilities. 

```{r}
library(GGally)
library(dplyr)
df_ability <- dota2[,c("total_gold","kills","kda","tower_damage", "total_xp", "ability")]
GGally::ggparcoord(data = df_ability, columns = 1:5, alphaLines = .4,
                   groupColumn = 6, splineFactor = TRUE, title = "Parallel Coordinates Plot")
```

```{r}
library(parcoords)
df <- dota2[,c("total_gold","kills","kda","tower_damage", "total_xp")]
parcoords::parcoords(data = df, rownames = FALSE, brushMode = "1d-axes")
```


```{r}
df <- df[df$kills > 17 & df$total_xp > 50000  & df$total_gold > 54000 & df$tower_damage > 7500,]
parcoords::parcoords(data = df, rownames = FALSE, brushMode = "1d-axes")
```
```{r}
df_ability <- df_ability[df_ability$kills > 17 & df_ability$total_xp > 50000  & df_ability$total_gold > 54000 & df_ability$tower_damage > 7500,]
df_ability
```

Answer to the question:\
From the interactive parallel coordinate plot, I select a specific region where these abilities have relatively high values across all five attributes and I filter the dataset based on that. In total, I select 4 top abilities through these parallel coordinate plots, which are the following:\
1. silencer_glaives_of_wisdom\
2. omniknight_hammer_of_purity\
3. kunkka_tidebringer\
4. drow_ranger_marksmanship\

## Second Research Question

Do abilities function better on radiant or dire?

To answer the question, we decide to draw mosaic plot here because it can incorporate group size into account and can clearly show the relationship between multiple categorical variables, which are win, isRadient, and ability. 

```{r}
library(vcd)
library(RColorBrewer)
df_2 = dota2[dota2$ability == "silencer_glaives_of_wisdom" | dota2$ability == "omniknight_hammer_of_purity" | dota2$ability == "kunkka_tidebringer" | dota2$ability == "drow_ranger_marksmanship",]
df_2[df_2 == "silencer_glaives_of_wisdom"] <- 's'
df_2[df_2 == "omniknight_hammer_of_purity"] <- 'o'
df_2[df_2 == "kunkka_tidebringer"] <- 'k'
df_2[df_2 == "drow_ranger_marksmanship"] <- 'd'

vcd::mosaic(win~isRadiant+ability, data = df_2, direction = c("v","v","h"), highlighting_fill = brewer.pal(4, 'Set3'),) 
```
From the above plot we can see that for the ability "kunkka_tidebringer", we have a higher winning proportion when it is not radient (it is dire), while for the other three abilities chosen, we have a higher winning possibility when it is radient, so the relationship between abilities and radiant/dire really depends on the context. In our case, we would choose radient. 
